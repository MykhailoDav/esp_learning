# –®–≤–∏–¥–∫–∏–π –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏—á–Ω–∏–π —Ç–µ—Å—Ç PN532

## üîç –©–æ —Ü–µ?

–ü—Ä–æ—Å—Ç–∏–π —Ç–µ—Å—Ç –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —á–æ–º—É PN532 –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ –∫–æ–º–∞–Ω–¥–∏.

## üöÄ –Ø–∫ –∑–∞–ø—É—Å—Ç–∏—Ç–∏

### –í–∞—Ä—ñ–∞–Ω—Ç 1: –¢–∏–º—á–∞—Å–æ–≤–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ main.c

```bash
# –ó–±–µ—Ä–µ–≥—Ç–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π main.c
cd /Users/yurkin/Documents/study/esp/nfc
cp src/main.c src/main.c.backup

# –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª
cp test/test_i2c_pn532.c src/main.c

# –ó—ñ–±—Ä–∞—Ç–∏ —Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏
pio run -t upload && pio device monitor
```

### –í–∞—Ä—ñ–∞–Ω—Ç 2: –°—Ç–≤–æ—Ä–∏—Ç–∏ –æ–∫—Ä–µ–º–∏–π –ø—Ä–æ–µ–∫—Ç

```bash
# –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ñ–∞–π–ª —É src/
cp test/test_i2c_pn532.c src/test_main.c

# –í—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ platformio.ini, –∑–º—ñ–Ω–∏—Ç–∏:
# build_src_filter = +<test_main.c>

# –ó—ñ–±—Ä–∞—Ç–∏ —Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏
pio run -t upload && pio device monitor
```

### –í–∞—Ä—ñ–∞–Ω—Ç 3: –ü—Ä–æ—Å—Ç–æ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –≤–∏—Å–Ω–æ–≤–æ–∫

–¶–µ–π —Ç–µ—Å—Ç –≤–∏–∫–æ–Ω—É—î:
1. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫—É –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –Ω–∞ I2C (–∞–¥—Ä–µ—Å–∞ 0x24)
2. üìñ –ß–∏—Ç–∞–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É PN532
3. üì§ –í—ñ–¥–ø—Ä–∞–≤–∫—É –∫–æ–º–∞–Ω–¥–∏ –ø—Ä–æ–±—É–¥–∂–µ–Ω–Ω—è
4. üì• –°–ø—Ä–æ–±—É –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ ACK –≤—ñ–¥–ø–æ–≤—ñ–¥—å

## üìä –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –Ø–∫—â–æ PN532 –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ I2C:

```
I: TEST 1: I2C Device Detection
I:   ‚úì Device responds to I2C address 0x24
I: TEST 2: Reading Status Byte
I:   ‚úì Status byte read: 0x01
I:   ‚úì PN532 reports READY
I: TEST 3: Sending Wakeup Command
I:   ‚úì Wakeup command sent successfully
I: TEST 4: Reading ACK Response
I:   ‚úì Read 25 bytes:
I:   ‚úì ACK frame found at position 1
```

### –Ø–∫—â–æ PN532 –ù–ï –≤ —Ä–µ–∂–∏–º—ñ I2C (–≤–∞—à –≤–∏–ø–∞–¥–æ–∫):

```
I: TEST 1: I2C Device Detection
I:   ‚úì Device responds to I2C address 0x24
I: TEST 2: Reading Status Byte
E:   ‚úó Failed to read status: ESP_ERR_TIMEOUT
I: TEST 3: Sending Wakeup Command
E:   ‚úó Failed to send wakeup: ESP_ERR_TIMEOUT
```

## üéØ –î—ñ–∞–≥–Ω–æ–∑

–Ø–∫—â–æ:
- ‚úÖ TEST 1 –ø—Ä–æ–π–¥–µ–Ω–æ (–ø—Ä–∏—Å—Ç—Ä—ñ–π –∑–Ω–∞–π–¥–µ–Ω–æ)
- ‚ùå TEST 2-4 –ø—Ä–æ–≤–∞–ª–µ–Ω—ñ (—Ç–∞–π–º–∞—É—Ç–∏)

**–¶–µ –æ–∑–Ω–∞—á–∞—î: PN532 —Ñ—ñ–∑–∏—á–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π, –∞–ª–µ –Ω–µ –≤ —Ä–µ–∂–∏–º—ñ I2C!**

## üìù –†—ñ—à–µ–Ω–Ω—è

1. **–í–∏–º–∫–Ω—ñ—Ç—å –∂–∏–≤–ª–µ–Ω–Ω—è** (–≤—ñ–¥–∫–ª—é—á—ñ—Ç—å USB)
2. **–ó–Ω–∞–π–¥—ñ—Ç—å DIP-–ø–µ—Ä–µ–º–∏–∫–∞—á—ñ** –Ω–∞ –º–æ–¥—É–ª—ñ PN532
3. **–ü–µ—Ä–µ—Å—Ç–∞–≤—Ç–µ –ø–µ—Ä–µ–º–∏–∫–∞—á—ñ:**
   ```
   Switch 1: ON  (–≤–≤–µ—Ä—Ö ‚¨ÜÔ∏è)
   Switch 2: OFF (–≤–Ω–∏–∑ ‚¨áÔ∏è)
   ```
4. **–£–≤—ñ–º–∫–Ω—ñ—Ç—å –∂–∏–≤–ª–µ–Ω–Ω—è** –∑–Ω–æ–≤—É
5. **–ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç** —â–µ —Ä–∞–∑

## üì∏ –Ø–∫ –≤–∏–≥–ª—è–¥–∞—é—Ç—å –ø–µ—Ä–µ–º–∏–∫–∞—á—ñ

### Adafruit PN532:
```
–ù–∞ –∑–∞–¥–Ω—ñ–π —Å—Ç–æ—Ä–æ–Ω—ñ –ø–ª–∞—Ç–∏:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  SEL0  SEL1 ‚îÇ
‚îÇ   ON   OFF  ‚îÇ ‚Üê –î–ª—è I2C
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Elechouse PN532 V3:
```
–ù–∞ –≤–µ—Ä—Ö–Ω—ñ–π —Å—Ç–æ—Ä–æ–Ω—ñ:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   1    2    ‚îÇ
‚îÇ  ON   OFF   ‚îÇ ‚Üê –î–ª—è I2C
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üîÑ –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è main.c

–ü—ñ—Å–ª—è —Ç–µ—Å—Ç—É –ø–æ–≤–µ—Ä–Ω—ñ—Ç—å –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª:

```bash
cd /Users/yurkin/Documents/study/esp/nfc
mv src/main.c.backup src/main.c
pio run -t upload
```

## üìñ –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è: **PN532_I2C_MODE_SETUP.md**
